#!/bin/bash

# –ë—ã—Å—Ç—Ä—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è macOS
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ./quick_update_macos.sh

echo "üöÄ –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ macOS"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏
CURRENT_VERSION=$(sw_vers -productVersion)
echo "–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: macOS ${CURRENT_VERSION}"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥–µ–ª–∏ Mac
MODEL=$(system_profiler SPHardwareDataType | grep "Model Identifier" | awk '{print $3}')
echo "–ú–æ–¥–µ–ª—å Mac: ${MODEL}"
echo ""

# –í–∞–∂–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –¥–ª—è MacBook9,1
if [ "$MODEL" = "MacBook9,1" ]; then
    echo "‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: MacBook 12\" 2016 (MacBook9,1)"
    echo "   –≠—Ç–∞ –º–æ–¥–µ–ª—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–æ macOS 12.x (Monterey)"
    echo "   macOS 14+ –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–æ–π –º–æ–¥–µ–ª–∏"
    echo ""
    echo "–í–∞—Ä–∏–∞–Ω—Ç—ã:"
    echo "1. –û—Å—Ç–∞—Ç—å—Å—è –Ω–∞ macOS 12.7.6 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)"
    echo "2. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ macOS 13.x (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ, –Ω–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ)"
    echo "3. –û—Ç–∫—Ä—ã—Ç—å App Store –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π"
    echo ""
    read -p "–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç (1-3): " -n 1 -r
    echo ""
    echo ""
    
    case $REPLY in
        1)
            echo "‚úì –û—Å—Ç–∞—ë–º—Å—è –Ω–∞ macOS 12.7.6"
            echo "  –ü—Ä–æ–≤–µ—Ä—è—é –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏..."
            softwareupdate --list
            ;;
        2)
            echo "‚ö†Ô∏è  –ü–æ–ø—ã—Ç–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ macOS 13.x..."
            echo "  –û—Ç–∫—Ä—ã–≤–∞—é App Store..."
            open "macappstore://apps.apple.com/app/id1576738294"
            ;;
        3)
            echo "üì± –û—Ç–∫—Ä—ã–≤–∞—é App Store..."
            open "macappstore://apps.apple.com/app/id1576738294"
            ;;
        *)
            echo "–û—Ç–º–µ–Ω–∞"
            exit 0
            ;;
    esac
else
    # –î–ª—è –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π Mac
    echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π..."
    softwareupdate --list
    echo ""
    echo "–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ macOS:"
    echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ App Store"
    echo "2. –ù–∞–π–¥–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é macOS"
    echo "3. –ù–∞–∂–º–∏—Ç–µ '–ó–∞–≥—Ä—É–∑–∏—Ç—å'"
    echo ""
    read -p "–û—Ç–∫—Ä—ã—Ç—å App Store —Å–µ–π—á–∞—Å? (y/n): " -n 1 -r
    echo ""
    if [[ $REPLY =~ ^[Yy]$ ]]; then
        open "macappstore://apps.apple.com/app/id1576738294"
    fi
fi

echo ""
echo "–ì–æ—Ç–æ–≤–æ!"

