# ðŸŽ‰ Ð”ÐµÐ¿Ð»Ð¾Ð¹ Calorio API - Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ ÑÑ‚Ð°Ñ‚ÑƒÑ

## âœ… Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾ Ð½Ð° 95%

### Ð£ÑÐ¿ÐµÑˆÐ½Ð¾ Ñ€Ð°Ð·Ð²Ñ‘Ñ€Ð½ÑƒÑ‚Ð¾:

#### 1. Ð¡ÐµÑ€Ð²ÐµÑ€ âœ…
- IP: 217.26.29.106
- ÐžÐ¡: Ubuntu 22.04.5 LTS
- Ð”Ð¾ÑÑ‚ÑƒÐ¿: SSH Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚

#### 2. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ð¾Ðµ ÐŸÐž âœ…
- âœ… Python 3.11
- âœ… PostgreSQL 14 (Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½)
- âœ… Nginx (Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½)
- âœ… Build tools
- âœ… Git

#### 3. Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… âœ…
- âœ… Ð‘Ð°Ð·Ð° `calorio` ÑÐ¾Ð·Ð´Ð°Ð½Ð°
- âœ… ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ `calorio_user` ÑÐ¾Ð·Ð´Ð°Ð½
- âœ… ÐŸÑ€Ð°Ð²Ð° Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ñ‹
- âœ… Ð’ÑÐµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ñ‹ (38 Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¹)

#### 4. ÐŸÑ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ âœ…
- âœ… ÐšÐ¾Ð´ ÐºÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ð¸Ð· GitHub
- âœ… Ð’Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¾
- âœ… Ð’ÑÐµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ (Django 5.1.4)
- âœ… Ð¡Ñ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ ÑÐ¾Ð±Ñ€Ð°Ð½Ñ‹ (163 Ñ„Ð°Ð¹Ð»Ð°)
- âœ… Gunicorn Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ (3 Ð²Ð¾Ñ€ÐºÐµÑ€Ð°)
- âœ… Systemd service Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½ Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚

#### 5. Nginx âœ…
- âœ… ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð°
- âœ… Upstream Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½
- âœ… Proxy headers Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ñ‹
- âœ… Nginx Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑ‰ÐµÐ½

### ðŸ”§ Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸:

#### .env Ñ„Ð°Ð¹Ð»
Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð°: SECRET_KEY Ð½Ðµ Ð±Ñ‹Ð» Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½, Ð¸ localhost Ð½Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ð² ALLOWED_HOSTS.

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ (Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ):**

```bash
ssh root@217.26.29.106
# ÐŸÐ°Ñ€Ð¾Ð»ÑŒ: C&6!wMqm!wOZ

# ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒÑÑ Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ calorio
sudo -u calorio bash
cd /var/www/calorio

# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ .env
cat > .env << 'EOF'
SECRET_KEY=django-prod-$(openssl rand -hex 32 | tr -d '\n')
DEBUG=False
ALLOWED_HOSTS=217.26.29.106,colories.ru,www.colories.ru,localhost,127.0.0.1
DATABASE_URL=postgresql://calorio_user:calorio_secure_2024@localhost:5432/calorio
OPENROUTER_API_KEY=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
PAYMENT_WEBHOOK_SECRET=webhook-$(openssl rand -hex 16 | tr -d '\n')
CORS_ALLOWED_ORIGINS=https://colories.ru,https://www.colories.ru,http://colories.ru,http://www.colories.ru,http://217.26.29.106
EOF

# Ð’Ñ‹Ð¹Ñ‚Ð¸ Ð¸Ð· Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ calorio
exit

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Gunicorn
systemctl restart calorio

# ÐŸÐ¾Ð´Ð¾Ð¶Ð´Ð°Ñ‚ÑŒ 3 ÑÐµÐºÑƒÐ½Ð´Ñ‹
sleep 3

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ API
curl http://localhost/api/health/
```

## ðŸ“Š Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÑ‚Ð°Ñ‚ÑƒÑ

### Ð Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ âœ…
- PostgreSQL: âœ… Ð—Ð°Ð¿ÑƒÑ‰ÐµÐ½
- Nginx: âœ… Ð—Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½
- Gunicorn: âœ… Ð—Ð°Ð¿ÑƒÑ‰ÐµÐ½ (3 Ð²Ð¾Ñ€ÐºÐµÑ€Ð°)
- Systemd: âœ… ÐÐ²Ñ‚Ð¾Ð·Ð°Ð¿ÑƒÑÐº Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½

### Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ðŸ”§
- .env: ÐÑƒÐ¶Ð½Ð¾ Ð¿ÐµÑ€ÐµÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸ÑÐ¼Ð¸
- ALLOWED_HOSTS: Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ localhost Ð¸ 127.0.0.1

## ðŸŽ¯ ÐŸÐ¾ÑÐ»Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ API Ð±ÑƒÐ´ÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½:

- http://217.26.29.106/api/
- http://colories.ru/api/
- http://217.26.29.106/api/docs/ (Swagger)
- http://217.26.29.106/api/redoc/ (ReDoc)
- http://217.26.29.106/api/health/ (Health check)

## ðŸ“ Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑˆÐ°Ð³Ð¸ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾):

### 1. SSL ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚
```bash
apt install -y certbot python3-certbot-nginx
certbot --nginx -d colories.ru -d www.colories.ru
```

### 2. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
```bash
sudo -u calorio bash
cd /var/www/calorio
source venv/bin/activate
python manage.py createsuperuser
```

### 3. ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð»Ð¾Ð³Ð¾Ð²
```bash
# Ð›Ð¾Ð³Ð¸ Gunicorn
journalctl -u calorio -f
tail -f /var/www/calorio/logs/gunicorn-error.log

# Ð›Ð¾Ð³Ð¸ Nginx
tail -f /var/log/nginx/error.log
```

## âœ¨ Ð˜Ñ‚Ð¾Ð³

Ð”ÐµÐ¿Ð»Ð¾Ð¹ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ Ð½Ð° **95%**. 

Ð’ÑÑ‘ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚, Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ .env Ñ„Ð°Ð¹Ð» (2 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹).

ÐŸÐ¾ÑÐ»Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ .env:
- âœ… API Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÐµÐ½
- âœ… Ð’ÑÐµ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ñ‹ Ð±ÑƒÐ´ÑƒÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹
- âœ… Ð¤Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´ ÑÐ¼Ð¾Ð¶ÐµÑ‚ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒÑÑ
- âœ… ÐŸÑ€Ð¾ÐµÐºÑ‚ Ð³Ð¾Ñ‚Ð¾Ð² Ðº production

---

**Ð”Ð°Ñ‚Ð°**: 9 Ð´ÐµÐºÐ°Ð±Ñ€Ñ 2025
**Ð¡Ñ‚Ð°Ñ‚ÑƒÑ**: 95% Ð³Ð¾Ñ‚Ð¾Ð², Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð°Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° .env

